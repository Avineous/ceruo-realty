<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Properties — CeruO Realty</title>
  <meta name="description" content="CeruO Realty — Featured properties across US, UK, Canada, Australia and Dubai. Click a listing for full details, brochures and contact actions." />

  <!-- Fonts (same as homepage) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Ionicons for icons -->
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="/style-fixed.css" />

  <style>
    /* header tweaks kept from your original */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background: rgba(6,38,60,0.92);
      position: relative;
      z-index: 60;
      gap: 18px;
    }
    .header-logo { height: 62px; width: auto; display: inline-block; }
    .header-center { display:flex; flex-direction:column; align-items:center; margin:0 20px; }
    .header-phrase { font-size: 1rem; font-weight: 700; color: #fff; margin-bottom:6px; letter-spacing:0.2px; }
    .header-search { display:flex; width:100%; max-width:360px; }
    .header-search input { flex:1; padding:8px 10px; border-radius:6px 0 0 6px; border:none; font-size:0.95rem; }
    .header-search button { padding:8px 12px; border:none; border-radius:0 6px 6px 0; background:#ffd166; color:#053049; font-weight:700; cursor:pointer; }
    .nav { display:flex; gap:0; align-items:center; }
    .nav a { color:#fff; text-decoration:none; font-weight:600; padding:6px 10px; }
    .nav a + a::before { content:"|"; color: rgba(255,255,255,0.25); margin: 0 10px; }

    /* Listing grid styles (minimal, adapt to your existing css) */
    .properties-set { display:grid; grid-template-columns: repeat(auto-fit, minmax(320px,1fr)); gap:20px; margin-top:18px; }
    .property-card { background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 6px 18px rgba(4,18,32,0.06); display:flex; flex-direction:column; }
    .property-thumb { width:100%; height:220px; object-fit:cover; display:block; }
    .property-body { padding:16px; }
    .property-body h3 { margin:0 0 6px 0; font-size:1.05rem; color:#053049; }
    .property-price { color:#053049; font-weight:700; margin:6px 0; }
    .property-meta { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; color:#333; font-size:0.95rem; }
    .property-actions { margin-top:12px; display:flex; gap:8px; }
    .btn { background:#053049; border:none; color:#fff; padding:8px 12px; border-radius:6px; text-decoration:none; font-weight:700; }
    .country-links { display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
    .country-links a { padding:6px 10px; background:#f3f6f8; border-radius:6px; color:#053049; text-decoration:none; font-weight:600; }
    .muted { color:#666; font-style:italic; }

    @media (max-width:900px) {
      .header-search { max-width:240px; }
      .header-logo { height:48px; }
      .header-phrase { font-size:0.95rem; }
      .property-thumb { height:180px; }
    }
  </style>
</head>
<body>
  <!-- Header: same layout as homepage -->
  <header class="header" role="banner">
    <a href="/index.html" aria-label="CeruO Realty home">
      <img src="/images/ceruo-logo-white.svg" alt="CeruO Realty" class="header-logo" />
    </a>

    <div class="header-center" role="search">
      <div class="header-phrase">Smart. Seamless. Secure. — Global Listings Demo</div>
      <div class="header-search">
        <input type="search" placeholder="Search by area, type or price (e.g., Brooklyn, 2BR, $750k)" aria-label="Search properties" />
        <button type="button">Search</button>
      </div>
    </div>

    <nav class="nav" aria-label="Main navigation">
      <a href="/index.html" class="nav-links">About</a>
      <a href="/properties.html" class="nav-links active">Properties</a>
      <a href="/faq.html" class="nav-links">FAQ</a>
      <a href="#contact" class="nav-links">Contact</a>
    </nav>
  </header>

  <main class="main">
    <section class="section">
      <h1 class="secondary-heading">Available Properties (International Demo)</h1>
      <p class="hero-description">Browse example properties across multiple markets. Use the country links below or add <code>?country=US</code> (or UK / CA / AU / AE) to the URL.</p>

      <div class="country-links" style="margin-bottom:12px;">
        <a href="/properties.html?country=US">United States</a>
        <a href="/properties.html?country=UK">United Kingdom</a>
        <a href="/properties.html?country=CA">Canada</a>
        <a href="/properties.html?country=AU">Australia</a>
        <a href="/properties.html?country=AE">Dubai (UAE)</a>
      </div>

      <div id="listings-root" class="properties-set" aria-live="polite">
        <!-- Listings will be rendered here by JavaScript -->
      </div>

      <div id="no-listings" style="text-align:center; margin-top:20px; display:none;">
        <p class="muted">No listings found for this region yet. You can add demo listings in <code>data/listings.json</code>.</p>
        <p><a href="/index.html" class="btn">Back to Home</a></p>
      </div>

    </section>
  </main>

  <footer class="footer">
    <div class="footer-container">
      <a href="/index.html"><img src="/images/ceruo-logo-bw.svg" alt="CeruO Realty" class="footer-logo" /></a>
      <p>© 2025 CeruO Realty — Demo site.</p>
    </div>
  </footer>

  <!-- Listings rendering script -->
  <script>
    // Utility: get query param (country or default AE)
    function getCountryFromQuery() {
      const params = new URLSearchParams(window.location.search);
      const c = params.get('country') || 'AE';
      return String(c).toUpperCase();
    }

    // Render a single card HTML safe
    function renderCard(item, country) {
      // Fallback image if missing
      const img = (item.image && item.image.length) ? item.image : '/images/ceruo-001-placeholder.svg';
      const price = item.price || '';
      const city = item.city || '';
      const summary = item.summary || '';
      const beds = item.beds ? `<span title="${item.beds} beds"><ion-icon name="bed-outline"></ion-icon> ${item.beds}</span>` : '';
      const baths = item.baths ? `<span title="${item.baths} baths"><ion-icon name="water-outline"></ion-icon> ${item.baths}</span>` : '';
      const sqft = item.sqft ? `<span><ion-icon name="golf-outline"></ion-icon> ${item.sqft}</span>` : '';
      const detailHref = `/properties/${item.id || 'unknown'}?country=${country}`;

      return `
        <article class="property-card" aria-labelledby="${item.id || ''}">
          <img src="${img}" class="property-thumb" alt="${escapeHtml(item.title || 'Listing')}" loading="lazy" onerror="this.onerror=null;this.src='/images/ceruo-001-placeholder.svg'"/>
          <div class="property-body">
            <p class="properties-loc"><ion-icon name="location-outline"></ion-icon> ${escapeHtml(city)}</p>
            <h3 id="${item.id || ''}">${escapeHtml(item.title || 'Untitled Property')}</h3>
            <p class="property-price">${escapeHtml(price)}</p>
            <p class="summary">${escapeHtml(summary)}</p>
            <div class="property-meta">${beds}${baths}${sqft}</div>
            <div class="property-actions">
              <a class="btn" href="${detailHref}">View details</a>
              <a class="btn" href="${item.brochure || '#'}" target="_blank">Brochure</a>
            </div>
          </div>
        </article>
      `;
    }

    // escape HTML to avoid injection
    function escapeHtml(str){
      if (!str) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    async function loadAndRenderListings() {
      const country = getCountryFromQuery();
      const root = document.getElementById('listings-root');
      const noListings = document.getElementById('no-listings');

      try {
        const res = await fetch('/data/listings.json', {cache: 'no-store'});
        if (!res.ok) throw new Error('Failed to fetch listings.json: ' + res.status);
        const data = await res.json();
        const list = (data && data[country]) ? data[country] : [];

        if (!list || list.length === 0) {
          root.innerHTML = '';
          noListings.style.display = 'block';
          return;
        }

        noListings.style.display = 'none';
        root.innerHTML = list.map(item => renderCard(item, country)).join('');
      } catch (err) {
        console.error('Error loading listings:', err);
        root.innerHTML = '<p class="muted">Failed to load listings. Ensure <code>/data/listings.json</code> exists and is valid JSON.</p>';
      }
    }

    // Run on DOM ready
    document.addEventListener('DOMContentLoaded', loadAndRenderListings);
  </script>

</body>
</html>
